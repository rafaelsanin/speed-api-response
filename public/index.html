<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <h1>Speed responses from thir-party API</h1>
    <p>Retrieves the cities which has the biggest occupancy in a specific state: </p>

    <label for="cities">Choose a state:</label>

    <select name="cities" id="cities">
        <option value="WA">Washington</option>
        <option value="NY">New York</option>
        <option value="CA">California</option>
        <option value="TX">Texas</option>
    </select>

    <button type="button" id="avg-button">Get biggest occupancy</button>

    <script>

        const getAvgBttn = document.getElementById('avg-button')

        function getReq() {
            return state = document.getElementById('cities').value
        }

        async function fetchAvg(state) {
            prvTimestamp = Date.now()
            console.log({'state': state, 'timestamp': prvTimestamp})
            const response = await fetch(`/biggestOccupancyByState/${state}`);
            const json = await response.json()
            lstTimestamp = Date.now()
            responseTime = (lstTimestamp-prvTimestamp) * 0.001
            console.log({'timestamp': lstTimestamp, 'responseTime': responseTime,'data': json}); 
        }

        getAvgBttn.addEventListener('click', () => {
            getReq();
            fetchAvg(state);
        })

    </script>

</body>

</html>