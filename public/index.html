<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <h1>Speed up slow function by caching</h1>
    <h2>Get average price for: </h2>

    <label for="cities">Choose a city:</label>

    <select name="cities" id="cities">
        <option value="FL">Florida</option>
        <option value="WA">Washington</option>
        <option value="TX">Texas</option>
    </select>

    <label for="frst-date">From:</label>
    <input type="date" id="frst-date" name="frst-date">

    <label for="lst-date">To:</label>
    <input type="date" id="lst-date" name="lst-date">

    <button type="button" id="avg-button">Get average price</button>

    <script>

        const getAvgBttn = document.getElementById('avg-button')

        function getReq() {
            return state = document.getElementById('cities').value
        }

        async function fetchAvg(state) {
            prvTimestamp = Date.now()
            console.log({'state': state, 'timestamp': prvTimestamp})
            const response = await fetch(`/historicalPerformance/${state}`);
            const json = await response.json()
            lstTimestamp = Date.now()
            responseTime = (lstTimestamp-prvTimestamp) * 0.001
            console.log({'timestamp': lstTimestamp, 'responseTime': responseTime,'data': json}); 
        }

        getAvgBttn.addEventListener('click', () => {
            getReq();
            fetchAvg(state);
        })

    </script>

</body>

</html>